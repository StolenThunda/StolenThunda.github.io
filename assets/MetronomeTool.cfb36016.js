import{u as Ue,a as Ke,b as Oe,Q as ue}from"./use-form.0d11b676.js";import{Q as He}from"./selection.e01d6ebc.js";import{a as Ge}from"./QBtn.6d4dd523.js";import{T as Je}from"./TouchPan.3883d4dd.js";import{a as Xe,u as Ye}from"./use-dark.430168dd.js";import{b as L}from"./format.801e7424.js";import{r as V,h as l,p as Ze,U as et,a8 as tt,a9 as H,j as h,g as he,w as fe,V as at,_ as lt,l as ot,A as B,I as N,D as $,C as ce,L as ve,J as de,K as p,H as d,G as P,F as J,aa as st,a4 as nt,a5 as rt}from"./index.2aa6dee5.js";import{b as it,c as ut}from"./use-router-link.9b827328.js";import{Q as ct}from"./QPage.4289fe44.js";import{d as vt}from"./pinia.b05c0e7a.js";const me="q-slider__marker-labels",dt=a=>({value:a}),mt=({marker:a})=>h("div",{key:a.value,style:a.style,class:a.classes},a.label),pe=[34,37,40,33,39,38],ht={...Ye,...Ue,min:{type:Number,default:0},max:{type:Number,default:100},innerMin:Number,innerMax:Number,step:{type:Number,default:1,validator:a=>a>=0},snap:Boolean,vertical:Boolean,reverse:Boolean,hideSelection:Boolean,color:String,markerLabelsClass:String,label:Boolean,labelColor:String,labelTextColor:String,labelAlways:Boolean,switchLabelSide:Boolean,markers:[Boolean,Number],markerLabels:[Boolean,Array,Object,Function],switchMarkerLabelsSide:Boolean,trackImg:String,trackColor:String,innerTrackImg:String,innerTrackColor:String,selectionColor:String,selectionImg:String,thumbSize:{type:String,default:"20px"},trackSize:{type:String,default:"4px"},disable:Boolean,readonly:Boolean,dense:Boolean,tabindex:[String,Number],thumbColor:String,thumbPath:{type:String,default:"M 4, 10 a 6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"}},ft=["pan","update:modelValue","change"];function pt({updateValue:a,updatePosition:n,getDragging:v,formAttrs:o}){const{props:e,emit:u,slots:C,proxy:{$q:f}}=he(),I=Xe(e,f),D=Ke(o),g=V(!1),w=V(!1),k=V(!1),q=V(!1),b=l(()=>e.vertical===!0?"--v":"--h"),Q=l(()=>"-"+(e.switchLabelSide===!0?"switched":"standard")),_=l(()=>e.vertical===!0?e.reverse===!0:e.reverse!==(f.lang.rtl===!0)),y=l(()=>isNaN(e.innerMin)===!0||e.innerMin<e.min?e.min:e.innerMin),S=l(()=>isNaN(e.innerMax)===!0||e.innerMax>e.max?e.max:e.innerMax),c=l(()=>e.disable!==!0&&e.readonly!==!0&&y.value<S.value),x=l(()=>(String(e.step).trim().split(".")[1]||"").length),T=l(()=>e.step===0?1:e.step),be=l(()=>c.value===!0?e.tabindex||0:-1),A=l(()=>e.max-e.min),Y=l(()=>S.value-y.value),F=l(()=>E(y.value)),j=l(()=>E(S.value)),R=l(()=>e.vertical===!0?_.value===!0?"bottom":"top":_.value===!0?"right":"left"),Z=l(()=>e.vertical===!0?"height":"width"),ge=l(()=>e.vertical===!0?"width":"height"),ee=l(()=>e.vertical===!0?"vertical":"horizontal"),ke=l(()=>{const t={role:"slider","aria-valuemin":y.value,"aria-valuemax":S.value,"aria-orientation":ee.value,"data-step":e.step};return e.disable===!0?t["aria-disabled"]="true":e.readonly===!0&&(t["aria-readonly"]="true"),t}),xe=l(()=>`q-slider q-slider${b.value} q-slider--${g.value===!0?"":"in"}active inline no-wrap `+(e.vertical===!0?"row":"column")+(e.disable===!0?" disabled":" q-slider--enabled"+(c.value===!0?" q-slider--editable":""))+(k.value==="both"?" q-slider--focus":"")+(e.label||e.labelAlways===!0?" q-slider--label":"")+(e.labelAlways===!0?" q-slider--label-always":"")+(I.value===!0?" q-slider--dark":"")+(e.dense===!0?" q-slider--dense q-slider--dense"+b.value:""));function z(t){const s="q-slider__"+t;return`${s} ${s}${b.value} ${s}${b.value}${Q.value}`}function te(t){const s="q-slider__"+t;return`${s} ${s}${b.value}`}const Ce=l(()=>{const t=e.selectionColor||e.color;return"q-slider__selection absolute"+(t!==void 0?` text-${t}`:"")}),_e=l(()=>te("markers")+" absolute overflow-hidden"),ye=l(()=>te("track-container")),Se=l(()=>z("pin")),Me=l(()=>z("label")),$e=l(()=>z("text-container")),Te=l(()=>z("marker-labels-container")+(e.markerLabelsClass!==void 0?` ${e.markerLabelsClass}`:"")),Ve=l(()=>"q-slider__track relative-position no-outline"+(e.trackColor!==void 0?` bg-${e.trackColor}`:"")),we=l(()=>{const t={[ge.value]:e.trackSize};return e.trackImg!==void 0&&(t.backgroundImage=`url(${e.trackImg}) !important`),t}),qe=l(()=>"q-slider__inner absolute"+(e.innerTrackColor!==void 0?` bg-${e.innerTrackColor}`:"")),ae=l(()=>{const t={[R.value]:`${100*F.value}%`,[Z.value]:`${100*(j.value-F.value)}%`};return e.innerTrackImg!==void 0&&(t.backgroundImage=`url(${e.innerTrackImg}) !important`),t});function Le(t){const{min:s,max:r,step:i}=e;let m=s+t*(r-s);if(i>0){const M=(m-s)%i;m+=(Math.abs(M)>=i/2?(M<0?-1:1)*i:0)-M}return x.value>0&&(m=parseFloat(m.toFixed(x.value))),L(m,y.value,S.value)}function E(t){return A.value===0?0:(t-e.min)/A.value}function Be(t,s){const r=et(t),i=e.vertical===!0?L((r.top-s.top)/s.height,0,1):L((r.left-s.left)/s.width,0,1);return L(_.value===!0?1-i:i,F.value,j.value)}const le=l(()=>tt(e.markers)===!0?e.markers:T.value),oe=l(()=>{const t=[],s=le.value,r=e.max;let i=e.min;do t.push(i),i+=s;while(i<r);return t.push(r),t}),se=l(()=>{const t=` ${me}${b.value}-`;return me+`${t}${e.switchMarkerLabelsSide===!0?"switched":"standard"}${t}${_.value===!0?"rtl":"ltr"}`}),W=l(()=>e.markerLabels===!1?null:Ie(e.markerLabels).map((t,s)=>({index:s,value:t.value,label:t.label||t.value,classes:se.value+(t.classes!==void 0?" "+t.classes:""),style:{...re(t.value),...t.style||{}}}))),ne=l(()=>({markerList:W.value,markerMap:Ae.value,classes:se.value,getStyle:re})),Ne=l(()=>{if(Y.value!==0){const t=100*le.value/Y.value;return{...ae.value,backgroundSize:e.vertical===!0?`2px ${t}%`:`${t}% 2px`}}return null});function Ie(t){if(t===!1)return null;if(t===!0)return oe.value.map(dt);if(typeof t=="function")return oe.value.map(r=>{const i=t(r);return H(i)===!0?{...i,value:r}:{value:r,label:i}});const s=({value:r})=>r>=e.min&&r<=e.max;return Array.isArray(t)===!0?t.map(r=>H(r)===!0?r:{value:r}).filter(s):Object.keys(t).map(r=>{const i=t[r],m=Number(r);return H(i)===!0?{...i,value:m}:{value:m,label:i}}).filter(s)}function re(t){return{[R.value]:`${100*(t-e.min)/A.value}%`}}const Ae=l(()=>{if(e.markerLabels===!1)return null;const t={};return W.value.forEach(s=>{t[s.value]=s}),t});function Fe(){if(C["marker-label-group"]!==void 0)return C["marker-label-group"](ne.value);const t=C["marker-label"]||mt;return W.value.map(s=>t({marker:s,...ne.value}))}const Re=l(()=>[[Je,ze,void 0,{[ee.value]:!0,prevent:!0,stop:!0,mouse:!0,mouseAllDir:!0}]]);function ze(t){t.isFinal===!0?(q.value!==void 0&&(n(t.evt),t.touch===!0&&a(!0),q.value=void 0,u("pan","end")),g.value=!1,k.value=!1):t.isFirst===!0?(q.value=v(t.evt),n(t.evt),a(),g.value=!0,u("pan","start")):(n(t.evt),a())}function ie(){k.value=!1}function Pe(t){n(t,v(t)),a(),w.value=!0,g.value=!0,document.addEventListener("mouseup",U,!0)}function U(){w.value=!1,g.value=!1,a(!0),ie(),document.removeEventListener("mouseup",U,!0)}function De(t){n(t,v(t)),a(!0)}function Qe(t){pe.includes(t.keyCode)&&a(!0)}function je(t){if(e.vertical===!0)return null;const s=f.lang.rtl!==e.reverse?1-t:t;return{transform:`translateX(calc(${2*s-1} * ${e.thumbSize} / 2 + ${50-100*s}%))`}}function Ee(t){const s=l(()=>w.value===!1&&(k.value===t.focusValue||k.value==="both")?" q-slider--focus":""),r=l(()=>`q-slider__thumb q-slider__thumb${b.value} q-slider__thumb${b.value}-${_.value===!0?"rtl":"ltr"} absolute non-selectable`+s.value+(t.thumbColor.value!==void 0?` text-${t.thumbColor.value}`:"")),i=l(()=>({width:e.thumbSize,height:e.thumbSize,[R.value]:`${100*t.ratio.value}%`,zIndex:k.value===t.focusValue?2:void 0})),m=l(()=>t.labelColor.value!==void 0?` text-${t.labelColor.value}`:""),M=l(()=>je(t.ratio.value)),K=l(()=>"q-slider__text"+(t.labelTextColor.value!==void 0?` text-${t.labelTextColor.value}`:""));return()=>{const O=[h("svg",{class:"q-slider__thumb-shape absolute-full",viewBox:"0 0 20 20","aria-hidden":"true"},[h("path",{d:e.thumbPath})]),h("div",{class:"q-slider__focus-ring fit"})];return(e.label===!0||e.labelAlways===!0)&&(O.push(h("div",{class:Se.value+" absolute fit no-pointer-events"+m.value},[h("div",{class:Me.value,style:{minWidth:e.thumbSize}},[h("div",{class:$e.value,style:M.value},[h("span",{class:K.value},t.label.value)])])])),e.name!==void 0&&e.disable!==!0&&D(O,"push")),h("div",{class:r.value,style:i.value,...t.getNodeData()},O)}}function We(t,s,r,i){const m=[];e.innerTrackColor!=="transparent"&&m.push(h("div",{key:"inner",class:qe.value,style:ae.value})),e.selectionColor!=="transparent"&&m.push(h("div",{key:"selection",class:Ce.value,style:t.value})),e.markers!==!1&&m.push(h("div",{key:"marker",class:_e.value,style:Ne.value})),i(m);const M=[it("div",{key:"trackC",class:ye.value,tabindex:s.value,...r.value},[h("div",{class:Ve.value,style:we.value},m)],"slide",c.value,()=>Re.value)];if(e.markerLabels!==!1){const K=e.switchMarkerLabelsSide===!0?"unshift":"push";M[K](h("div",{key:"markerL",class:Te.value},Fe()))}return M}return Ze(()=>{document.removeEventListener("mouseup",U,!0)}),{state:{active:g,focus:k,preventFocus:w,dragging:q,editable:c,classes:xe,tabindex:be,attributes:ke,step:T,decimals:x,trackLen:A,innerMin:y,innerMinRatio:F,innerMax:S,innerMaxRatio:j,positionProp:R,sizeProp:Z,isReversed:_},methods:{onActivate:Pe,onMobileClick:De,onBlur:ie,onKeyup:Qe,getContent:We,getThumbRenderFn:Ee,convertRatioToModel:Le,convertModelToRatio:E,getDraggingRatio:Be}}}const bt=()=>({});var G=ut({name:"QSlider",props:{...ht,modelValue:{required:!0,default:null,validator:a=>typeof a=="number"||a===null},labelValue:[String,Number]},emits:ft,setup(a,{emit:n}){const{proxy:{$q:v}}=he(),{state:o,methods:e}=pt({updateValue:b,updatePosition:_,getDragging:Q,formAttrs:Oe(a)}),u=V(null),C=V(0),f=V(0);function I(){f.value=a.modelValue===null?o.innerMin.value:L(a.modelValue,o.innerMin.value,o.innerMax.value)}fe(()=>`${a.modelValue}|${o.innerMin.value}|${o.innerMax.value}`,I),I();const D=l(()=>e.convertModelToRatio(f.value)),g=l(()=>o.active.value===!0?C.value:D.value),w=l(()=>{const c={[o.positionProp.value]:`${100*o.innerMinRatio.value}%`,[o.sizeProp.value]:`${100*(g.value-o.innerMinRatio.value)}%`};return a.selectionImg!==void 0&&(c.backgroundImage=`url(${a.selectionImg}) !important`),c}),k=e.getThumbRenderFn({focusValue:!0,getNodeData:bt,ratio:g,label:l(()=>a.labelValue!==void 0?a.labelValue:f.value),thumbColor:l(()=>a.thumbColor||a.color),labelColor:l(()=>a.labelColor),labelTextColor:l(()=>a.labelTextColor)}),q=l(()=>o.editable.value!==!0?{}:v.platform.is.mobile===!0?{onClick:e.onMobileClick}:{onMousedown:e.onActivate,onFocus:y,onBlur:e.onBlur,onKeydown:S,onKeyup:e.onKeyup});function b(c){f.value!==a.modelValue&&n("update:modelValue",f.value),c===!0&&n("change",f.value)}function Q(){return u.value.getBoundingClientRect()}function _(c,x=o.dragging.value){const T=e.getDraggingRatio(c,x);f.value=e.convertRatioToModel(T),C.value=a.snap!==!0||a.step===0?T:e.convertModelToRatio(f.value)}function y(){o.focus.value=!0}function S(c){if(!pe.includes(c.keyCode))return;at(c);const x=([34,33].includes(c.keyCode)?10:1)*o.step.value,T=([34,37,40].includes(c.keyCode)?-1:1)*(o.isReversed.value===!0?-1:1)*(a.vertical===!0?-1:1)*x;f.value=L(parseFloat((f.value+T).toFixed(o.decimals.value)),o.innerMin.value,o.innerMax.value),b()}return()=>{const c=e.getContent(w,o.tabindex,q,x=>{x.push(k())});return h("div",{ref:u,class:o.classes.value+(a.modelValue===null?" q-slider--no-value":""),...o.attributes.value,"aria-valuenow":a.modelValue},c)}}});const gt=vt("metronome",{state:()=>({audioContext:null,isPlaying:!1,startTime:null,currentTwelveNote:null,tempo:120,meter:4,masterVolume:50,accentVolume:100,quarterVolume:75,eighthVolume:0,sixteenthVolume:0,tripletVolume:0,lookahead:25,scheduleAheadTime:.1,nextNoteTime:0,noteLength:.05,notesInQueue:[],timerWorker:null,volumeNames:["master","accent","quarter","eighth","sixteenth","triplet"],indicatorIdx:0}),getters:{maxBeats(a){return a.meter*12}},actions:{calcVolume(a){return a*this.masterVolume},scheduleNote(a,n){this.notesInQueue.push({note:a,time:n});var v=this.audioContext.createOscillator(),o=this.audioContext.createGain();v.connect(o),o.connect(this.audioContext.destination),a%this.maxBeats===0?this.accentVolume>.25?(v.frequency.value=880,o.gain.value=this.calcVolume(this.accentVolume)):(v.frequency.value=440,o.gain.value=this.calcVolume(this.quarterVolume)):a%12===0?(v.frequency.value=440,o.gain.value=this.calcVolume(this.quarterVolume)):a%6===0?(v.frequency.value=440,o.gain.value=this.calcVolume(this.eighthVolume)):a%4===0?(v.frequency.value=300,o.gain.value=this.calcVolume(this.tripletVolume)):a%3===0?(v.frequency.value=220,o.gain.value=this.calcVolume(this.sixteenthVolume)):o.gain.value=0,v.start(n),o.gain.value>0&&(this.indicatorIdx=a/12),v.stop(n+this.noteLength)},scheduler(){for(;this.nextNoteTime<this.audioContext.currentTime+this.scheduleAheadTime;)this.scheduleNote(this.currentTwelveletNote,this.nextNoteTime),this.nextTwelvelet()},nextTwelvelet(){let a=60/this.tempo;this.nextNoteTime+=.08333*a,this.currentTwelveletNote++,this.currentTwelveletNote==this.maxBeats&&(this.currentTwelveletNote=0)},play(){this.isPlaying=!this.isPlaying,this.audioContext.resume(),this.isPlaying?(this.currentTwelveletNote=0,this.nextNoteTime=this.audioContext.currentTime,this.timerWorker.postMessage("start")):this.timerWorker.postMessage("stop")},init(){this.timerWorker=new Worker("worklets/metronome.worklet.js"),this.audioContext=new AudioContext,this.timerWorker.onmessage=function(a){a.data=="tick"?this.scheduler():console.log("message: "+a.data)}.bind(this),this.timerWorker.postMessage({interval:this.lookahead})}}});const X=a=>(nt("data-v-af78fc58"),a=a(),rt(),a),kt=["name","innerHTML"],xt={class:"fit row justify-between justify-evenly content-center"},Ct={class:"col-5-lg row"},_t={class:"column q-pa-lg q-ma-lg q-mt-xl"},yt={class:"q-pa-lg q-ma-lg"},St={class:""},Mt=X(()=>d("span",{class:"text-h5"},"Tempo",-1)),$t={class:"text-h3"},Tt=J(" bpm "),Vt=X(()=>d("span",{class:"text-h5"},"Meter",-1)),wt={class:"text-h3"},qt=J(" counts "),Lt={class:"q-px-md col-7"},Bt=X(()=>d("span",{class:"text-h4"},"Volumes",-1)),Nt={class:"column"},It={class:"text-h5"},At={class:"text-caption"},Ft={name:"MetronomeTool"},Rt=Object.assign(Ft,{setup(a){const n=gt();ot(()=>{n.init()}),fe(()=>n.indicatorIdx,o=>{o=o+1,document.querySelectorAll("[name^=indicator]").forEach(u=>{u.classList.remove("active")});let e=document.querySelector(`[name=indicator-${o}]`);e&&e.classList.add("active")});const v=o=>o.charAt(0).toUpperCase()+o.slice(1);return(o,e)=>(B(),N("div",null,[$(ct,null,{default:ce(()=>[$(He,{class:"content-center q-mt-md"},{default:ce(()=>[$(ue),(B(!0),N(ve,null,de(p(n).meter,u=>(B(),N("div",{name:`indicator-${u}`,class:st(["shadow-box shadow-20 shadow-transition text-weight-bolder text-overline q-mx-md non-selectable",u===1?"active":""]),key:u,innerHTML:u,role:"indicator"},null,10,kt))),128)),$(ue)]),_:1}),d("div",xt,[d("div",Ct,[d("div",_t,[$(Ge,{glossy:"",round:"",size:"3rem",icon:p(n).isPlaying?"mdi-pause":"mdi-play",color:"accent",onClick:p(n).play},null,8,["icon","onClick"])]),d("div",yt,[d("div",St,[Mt,d("p",null,[d("span",$t,P(p(n).tempo),1),Tt]),$(G,{modelValue:p(n).tempo,"onUpdate:modelValue":e[0]||(e[0]=u=>p(n).tempo=u),min:0,max:250},null,8,["modelValue"])]),d("div",null,[Vt,d("p",null,[d("span",wt,P(p(n).meter),1),qt]),$(G,{modelValue:p(n).meter,"onUpdate:modelValue":e[1]||(e[1]=u=>p(n).meter=u),min:0,max:12},null,8,["modelValue"])])])]),d("div",Lt,[Bt,d("section",Nt,[(B(!0),N(ve,null,de(p(n).volumeNames,u=>(B(),N("div",{key:u,class:"column"},[d("span",It,[J(P(v(u))+" ",1),d("span",At,"( "+P(p(n)[`${u}Volume`])+"% )",1)]),$(G,{modelValue:p(n)[`${u}Volume`],"onUpdate:modelValue":C=>p(n)[`${u}Volume`]=C,label:"","font-size":"1.2rem",size:"4rem",color:"accent"},null,8,["modelValue","onUpdate:modelValue"])]))),128))])])])]),_:1})]))}});var Ht=lt(Rt,[["__scopeId","data-v-af78fc58"]]);export{Ht as default};
