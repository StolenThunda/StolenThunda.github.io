{"version":3,"sources":["webpack:///./src/components/tools/Tuner.vue?d4b6","webpack:///./src/middleware/tools/tunerLib.js","webpack:///./src/middleware/tools/tuner.js","webpack:///src/components/tools/Tuner.vue","webpack:///./src/components/tools/Tuner.vue?e1bc","webpack:///./src/components/tools/Tuner.vue","webpack:///./src/components/tools/Tuner.vue?a6c6","webpack:///./src/components/tools/Tuner.vue?1077"],"names":["onAudioInput","evt","consoleMessage","data","length","console","log","onAudioInputError","error","alert","JSON","stringify","msg","debugVar","dir","getMicrophonePermission","onSuccess","onDenied","onError","window","audioinput","checkMicrophonePermission","hasPermission","message","ex","ConsoleMessage","Application","info","addEventListener","Tuner","a4","isIOS","middleA","semitone","bufferSize","noteStrings","checkIOSPerms","initGetUserMedia","prototype","AudioContext","webkitAudioContext","navigator","mediaDevices","undefined","getUserMedia","constraints","webkitGetUserMedia","mozGetUserMedia","Promise","resolve","reject","call","startRecord","self","start","stream","getStream","audioContext","getAudioContext","setup","audio","then","catch","name","createMediaStreamSource","connect","analyser","scriptProcessor","destination","event","frequency","pitchDetector","do","inputBuffer","getChannelData","onNoteDetected","note","getNote","value","cents","getCents","octave","parseInt","init","createAnalyser","createScriptProcessor","aubio","Pitch","sampleRate","Math","round","getStandardFrequency","pow","floor","play","oscillator","createOscillator","stop","isCapturing","deniedMsg","errorMsg","Notes","selector","tuner","isAutoMode","$root","document","querySelector","$notesList","$frequency","$notes","$notesMap","createNotes","minOctave","maxOctave","n","$note","createElement","className","dataset","toString","innerHTML","appendChild","push","forEach","$active","classList","remove","update","active","clearActive","add","scrollLeft","offsetLeft","clientWidth","childNodes","textContent","parseFloat","toFixed","toggleAutoMode","Meter","$pointer","i","$scale","style","transform","deg","FrequencyBars","$canvas","width","body","height","clientHeight","canvasContext","getContext","clearRect","globalAlpha","fillStyle","fillRect","localStorage","getItem","notes","meter","frequencyBars","lastNote","updateFrequencyBars","frequencyData","Uint8Array","frequencyBinCount","Object","values","some","v","getByteFrequencyData","requestAnimationFrame","bind","getQVAR","obj","app","q","computed","getA4","appInfo","toggleTones","get","set","mounted","methods","getQ","setFreq","getFreq","dialog","title","prompt","model","type","cancel","standout","onOk","onCancel","onDismiss","destroyed"],"mappings":"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","file":"js/4.1a3e8eb3.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[(_vm.toggleTones)?_c('q-item',{staticClass:\"q-mt-xl q-mr-lg absolute-top-right\",attrs:{\"dense\":\"\"}},[_c('q-item-section',[_c('q-icon',{attrs:{\"name\":\"notifications_active\",\"color\":\"accent\"}})],1),_c('q-item-section',{staticClass:\"text-accent text-subtitle1\"},[_vm._v(\"\\n        Tones Enabled\\n      \")])],1):_vm._e(),_c('q-fab',{staticClass:\"q-mt-xl q-ml-lg absolute-top-left bg-accent\",attrs:{\"label-position\":\"left\",\"icon\":\"settings\"}},[_c('q-fab-action',{attrs:{\"color\":\"accent\",\"outlined\":\"\",\"stacked\":\"\",\"push\":\"\",\"glossy\":\"\",\"rounded\":\"\"},on:{\"click\":_vm.getFreq}},[_c('div',{staticClass:\"text-body1\"},[_c('span',[_vm._v(\"A\"),_c('sub',[_vm._v(\"4\")])]),_vm._v(\"\\n           = \\n           \"),_c('span',[_vm._v(_vm._s(_vm.getA4)+\" \")]),_vm._v(\"\\n          Hz\\n        \")])]),_c('q-fab-action',[_c('q-toggle',{attrs:{\"label\":\"Enable Tones\",\"color\":\"accent\",\"checked-icon\":\"check\",\"unchecked-icon\":\"clear\"},model:{value:(_vm.toggleTones),callback:function ($$v) {_vm.toggleTones=$$v},expression:\"toggleTones\"}})],1)],1),_c('canvas',{staticClass:\"frequency-bars\"}),_vm._m(0),_c('div',{staticClass:\"notes\"},[_c('div',{staticClass:\"notes-list\"}),_vm._m(1),_c('div',[(_vm.appInfo !== null)?_c('q-btn',{staticClass:\"q-ma-md\",attrs:{\"color\":\"accent\",\"label\":\"Errors\",\"icon\":\"error\",\"stacked\":\"\",\"push\":\"\",\"glossy\":\"\",\"rounded\":\"\"},on:{\"click\":function($event){_vm.q = !_vm.q}}}):_vm._e(),_c('q-dialog',{model:{value:(_vm.q),callback:function ($$v) {_vm.q=$$v},expression:\"q\"}},[_c('q-card',{staticClass:\"text-body1 text-center\"},[_c('q-card-section',[_c('div',{staticClass:\"text-h5\"},[_vm._v(\"Error:\")])]),_c('q-card-section',{staticStyle:{\"max-height\":\"60vh\",\"max-width\":\"90vw\"}},[(_vm.appInfo)?_c('div',[_vm._v(_vm._s(_vm.app.info))]):_c('div',{attrs:{\"id\":\"infoMessage\"}},[_vm._v(_vm._s(_vm.getQ(_vm.$q)))])])],1)],1)],1)])],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"meter\"},[_c('div',{staticClass:\"meter-dot\"}),_c('div',{staticClass:\"meter-pointer\"})])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"frequency text-h5\"},[_c('span'),_vm._v(\"Hz\")])}]\n\nexport { render, staticRenderFns }","export const onAudioInput = (evt) => {\n  // 'evt.data' is an integer array containing raw audio data\n  //\n  consoleMessage(\"Audio data received: \" + evt.data.length + \" samples\");\n  console.log(\"Audio data received: \" + evt.data.length + \" samples\");\n\n  // ... do something with the evt.data array ...\n};\n\nexport const onAudioInputError = (error) => {\n  alert(\"onAudioInputError event recieved: \" + JSON.stringify(error));\n};\n\nexport function consoleMessage(msg, debugVar) {\n    if ( debugVar ) {\n        msg = `${msg}: ${debugVar}`;\n        if ( typeof debugVar == 'object' ) console.dir( msg, debugVar );\n        else console.log( msg );\n  } \n  console.log(msg);\n}\n\nexport function getMicrophonePermission ( onSuccess, onDenied, onError ) {\n    window.audioinput.checkMicrophonePermission( function ( hasPermission ) {\n        try {\n            if ( hasPermission ) {\n                if ( onSuccess )\n                    onSuccess();\n            } else {\n                window.audioinput.getMicrophonePermission( function (\n                    hasPermission,\n                    message\n                ) {\n                    try {\n                        if ( hasPermission ) {\n                            if ( onSuccess )\n                                onSuccess();\n                        } else {\n                            if ( onDenied )\n                                onDenied( \"User denied permission to record: \" + message );\n                        }\n                    } catch ( ex ) {\n                        if ( onError )\n                            onError( \"Start after getting permission exception: \" + ex );\n                    }\n                } );\n            }\n        } catch ( ex ) {\n            if ( onError )\n                onError( \"getMicrophonePermission exception: \" + ex );\n        }\n    } );\n}\n","import aubio from \"aubiojs\";\nimport { consoleMessage, getMicrophonePermission } from \"./tunerLib.js\";\n\nconst ConsoleMessage = ( ...message ) => {\n  // console.trace( message );\n  consoleMessage(message);\n  Application.info += message;\n};\n\nconst onAudioInput = (evt) => {\n  // 'evt.data' is an integer array containing raw audio data\n  //\n  // ConsoleMessage(\"Audio data received: \" + evt.data.length + \" samples\");\n\n  // ... do something with the evt.data array ...\n  // ConsoleMessage(typeof evt)\n};\n\nconst onAudioInputError = (error) => {\n  alert(\"onAudioInputError event recieved: \" + JSON.stringify(error));\n};\n\n// Listen to audioinput events\nwindow.addEventListener(\"audioinput\", onAudioInput, false);\n\n// Listen to audioinputerror events\nwindow.addEventListener(\"audioinputerror\", onAudioInputError, false);\n\n\nexport const Tuner = function (a4, isIOS) {\n  this.info = null;\n  this.middleA = a4 || 440;\n  this.semitone = 69;\n  this.bufferSize = 4096;\n  this.noteStrings = [\n    \"C\",\n    \"C♯\",\n    \"D\",\n    \"D♯\",\n    \"E\",\n    \"F\",\n    \"F♯\",\n    \"G\",\n    \"G♯\",\n    \"A\",\n    \"A♯\",\n    \"B\",\n  ];\n  this.isIOS = isIOS || false;\n  if (this.isIOS) {\n    ConsoleMessage(\"initialize IOS tuner\");\n    this.checkIOSPerms();\n  } else {\n    this.initGetUserMedia();\n    ConsoleMessage(\"initialize WebAudio tuner\");\n  }\n};\n\nTuner.prototype.initGetUserMedia = function () {\n  window.AudioContext = window.AudioContext || window.webkitAudioContext;\n  if (!window.AudioContext) {\n    return alert(\"AudioContext not supported\");\n  }\n\n  // Older browsers might not implement mediaDevices at all, so we set an empty object first\n  if (navigator.mediaDevices === undefined) {\n    navigator.mediaDevices = {};\n  }\n\n  // Some browsers partially implement mediaDevices. We can't just assign an object\n  // with getUserMedia as it would overwrite existing properties.\n  // Here, we will just add the getUserMedia property if it's missing.\n  if (navigator.mediaDevices.getUserMedia === undefined) {\n    navigator.mediaDevices.getUserMedia = function (constraints) {\n      // First get ahold of the legacy getUserMedia, if present\n      const getUserMedia =\n        navigator.webkitGetUserMedia || navigator.mozGetUserMedia;\n\n      // Some browsers just don't implement it - return a rejected promise with an error\n      // to keep a consistent interface\n      if (!getUserMedia) {\n        alert(\"getUserMedia is not implemented in this browser\");\n      }\n\n      // Otherwise, wrap the call to the old navigator.getUserMedia with a Promise\n      return new Promise(function (resolve, reject) {\n        getUserMedia?.call(navigator, constraints, resolve, reject);\n      });\n    };\n  }\n};\n\nTuner.prototype.startRecord = function () {\n  const self = this;\n  if (self.isIOS) {\n    ConsoleMessage(\"Microphone input starting...\");\n    window.audioinput.start();\n    ConsoleMessage(\"Microphone input started!\");\n    let stream = window.audioinput.getStream();\n    ConsoleMessage(`stream: ${stream}`);\n    this.audioContext = window.audioinput.getAudioContext();\n    self.setup(stream);\n  } else {\n    navigator.mediaDevices\n      .getUserMedia({ audio: true })\n      .then((stream) => self.setup(stream))\n      .then(() => ConsoleMessage(\"Microphone input started!\"))\n      .catch(function (error) {\n        alert(error.name + \": \" + error.message);\n      });\n  }\n};\nTuner.prototype.getAudioContext = function () {\n  return this.audioContext\n    ? this.audioContext\n    : window.audioinput\n    ? window.audioinput.getAudioContext()\n    : new (window.AudioContext || window.webkitAudioContext)();\n};\nTuner.prototype.setup = function (stream) {\n  const self = this;\n  ConsoleMessage(\"setup\");\n  self.audioContext = self.getAudioContext();\n  if (!stream) stream = window.audioinput.getStream();\n  ConsoleMessage(`stream: ${stream}`);\n  self.audioContext.createMediaStreamSource(stream).connect(self.analyser);\n  self.analyser.connect(self.scriptProcessor);\n  self.scriptProcessor.connect(self.audioContext.destination);\n  self.scriptProcessor.addEventListener(\"audioprocess\", function (event) {\n    const frequency = self.pitchDetector.do(\n      event.inputBuffer.getChannelData(0)\n      );\n      // ConsoleMessage(\"audioinput freq: \", frequency);\n    if (frequency && self.onNoteDetected) {\n      const note = self.getNote(frequency);\n      self.onNoteDetected({\n        name: self.noteStrings[note % 12],\n        value: note,\n        cents: self.getCents(frequency, note),\n        octave: parseInt(note / 12) - 1,\n        frequency: frequency,\n      });\n    }\n  });\n};\nTuner.prototype.init = function () {\n  this.audioContext = new (window.AudioContext || window.webkitAudioContext)();\n  ConsoleMessage(`audioContext: ${this.audioContext}`);\n  this.analyser = this.audioContext.createAnalyser();\n  this.scriptProcessor = this.audioContext.createScriptProcessor(\n    this.bufferSize,\n    1,\n    1\n  );\n\n  const self = this;\n\n  aubio().then(function (aubio) {\n    self.pitchDetector = new aubio.Pitch(\n      \"default\",\n      self.bufferSize,\n      1,\n      self.audioContext.sampleRate\n    );\n    self.startRecord();\n  });\n};\n\n/**\n * get musical note from frequency\n *\n * @param {number} frequency\n * @returns {number}\n */\nTuner.prototype.getNote = function (frequency) {\n  const note = 12 * (Math.log(frequency / this.middleA) / Math.log(2));\n  return Math.round(note) + this.semitone;\n};\n\n/**\n * get the musical note's standard frequency\n *\n * @param note\n * @returns {number}\n */\nTuner.prototype.getStandardFrequency = function (note) {\n  return this.middleA * Math.pow(2, (note - this.semitone) / 12);\n};\n\n/**\n * get cents difference between given frequency and musical note's standard frequency\n *\n * @param {number} frequency\n * @param {number} note\n * @returns {number}\n */\nTuner.prototype.getCents = function (frequency, note) {\n  return Math.floor(\n    (1200 * Math.log(frequency / this.getStandardFrequency(note))) / Math.log(2)\n  );\n};\n\n/**\n * play the musical note\n *\n * @param {number} frequency\n */\nTuner.prototype.play = function (frequency) {\n  this.audioContext = this.getAudioContext();\n  ConsoleMessage(`audioContext: ${this.audioContext}`);\n  if (!self.oscillator) {\n    self.oscillator = this.audioContext.createOscillator();\n    self.oscillator.connect(this.audioContext.destination);\n    self.oscillator.start();\n  }\n  self.oscillator.frequency.value = frequency;\n};\n\nTuner.prototype.stop = () => {\n  self?.oscillator.stop();\n  self.oscillator = null;\n\n  ConsoleMessage(\"Stopped!\");\n};\nTuner.prototype.checkIOSPerms = function () {\n  try {\n    if (window.audioinput && !window.audioinput.isCapturing()) {\n      getMicrophonePermission(\n        self.setup,\n        function (deniedMsg) {\n          ConsoleMessage(deniedMsg);\n        },\n        function (errorMsg) {\n          ConsoleMessage(errorMsg);\n        }\n      );\n    } else {\n      ConsoleMessage(\"Already capturing!\");\n    }\n  } catch (ex) {\n    ConsoleMessage(\"startCapture exception: \" + ex);\n  }\n};\nexport const Notes = function (selector, tuner) {\n  this.tuner = tuner;\n  this.isAutoMode = true;\n  this.$root = document.querySelector(selector);\n  this.$notesList = this.$root.querySelector(\".notes-list\");\n  this.$frequency = this.$root.querySelector(\".frequency\");\n  this.$notes = [];\n  this.$notesMap = {};\n  this.createNotes();\n};\n\nNotes.prototype.createNotes = function () {\n  const minOctave = 2;\n  const maxOctave = 5;\n  for (var octave = minOctave; octave <= maxOctave; octave += 1) {\n    for (var n = 0; n < 12; n += 1) {\n      const $note = document.createElement(\"div\");\n      $note.className = \"note\";\n      $note.dataset.name = this.tuner.noteStrings[n];\n      $note.dataset.value = 12 * (octave + 1) + n;\n      $note.dataset.octave = octave.toString();\n      $note.dataset.frequency = this.tuner.getStandardFrequency(\n        $note.dataset.value\n      );\n      $note.innerHTML =\n        $note.dataset.name[0] +\n        '<span class=\"note-sharp\">' +\n        ($note.dataset.name[1] || \"\") +\n        \"</span>\" +\n        '<span class=\"note-octave\">' +\n        $note.dataset.octave +\n        \"</span>\";\n      this.$notesList.appendChild($note);\n      this.$notes.push($note);\n      this.$notesMap[$note.dataset.value] = $note;\n    }\n  }\n\n  const self = this;\n  this.$notes.forEach(function ($note) {\n    $note.addEventListener(\"click\", function () {\n      if (self.isAutoMode) {\n        return;\n      }\n\n      const $active = self.$notesList.querySelector(\".active\");\n      if ($active === this) {\n        self.tuner.stop();\n        $active.classList.remove(\"active\");\n      } else {\n        self.tuner.play(this.dataset.frequency);\n        self.update($note.dataset);\n      }\n    });\n  });\n};\n\nNotes.prototype.active = function ($note) {\n  ConsoleMessage(\"active note:\", $note);\n  this.clearActive();\n  $note.classList.add(\"active\");\n  this.$notesList.scrollLeft =\n    $note.offsetLeft - (this.$notesList.clientWidth - $note.clientWidth) / 2;\n};\n\nNotes.prototype.clearActive = function () {\n  const $active = this.$notesList.querySelector(\".active\");\n  if ($active) {\n    $active.classList.remove(\"active\");\n  }\n};\n\nNotes.prototype.update = function (note) {\n  ConsoleMessage(\"update note val\", note.value);\n  if (note.value in this.$notesMap) {\n    this.active(this.$notesMap[note.value]);\n    this.$frequency.childNodes[0].textContent = parseFloat(\n      note.frequency\n    ).toFixed(1);\n  }\n};\n\nNotes.prototype.toggleAutoMode = function () {\n  if ( this.isAutoMode ) {\n    this.clearActive();\n  } else { this.tuner.stop() }\n  this.isAutoMode = !this.isAutoMode;\n};\n\n/**\n * @param {string} selector\n * @constructor\n */\nexport const Meter = function (selector) {\n  this.$root = document.querySelector(selector);\n  this.$pointer = this.$root.querySelector(\".meter-pointer\");\n  this.init();\n};\n\nMeter.prototype.init = function () {\n  for (var i = 0; i <= 10; i += 1) {\n    const $scale = document.createElement(\"div\");\n    $scale.className = \"meter-scale\";\n    $scale.style.transform = \"rotate(\" + (i * 9 - 45) + \"deg)\";\n    if (i % 5 === 0) {\n      $scale.classList.add(\"meter-scale-strong\");\n    }\n    this.$root.appendChild($scale);\n  }\n};\n\n/**\n * @param {number} deg\n */\nMeter.prototype.update = function (deg) {\n  ConsoleMessage(`deg: ${deg}`);\n  this.$pointer.style.transform = \"rotate(\" + deg + \"deg)\";\n};\n\n/**\n * the frequency histogram\n *\n * @param {string} selector\n * @constructor\n */\nexport const FrequencyBars = function (selector) {\n  this.$canvas = document.querySelector(selector);\n  this.$canvas.width = document.body.clientWidth;\n  this.$canvas.height = document.body.clientHeight / 2;\n  this.canvasContext = this.$canvas.getContext(\"2d\");\n};\n\n/**\n * @param {Uint8Array} data\n */\nFrequencyBars.prototype.update = function (data) {\n  const length = 64; // low frequency only\n  const width = this.$canvas.width / length - 0.5;\n  this.canvasContext.clearRect(0, 0, this.$canvas.width, this.$canvas.height);\n  this.canvasContext.globalAlpha = 0.35;\n  for (var i = 0; i < length; i += 1) {\n    this.canvasContext.fillStyle = \"#ef6c00\";\n    this.canvasContext.fillRect(\n      i * (width + 0.5),\n      this.$canvas.height - data[i],\n      width,\n      data[i]\n    );\n  }\n};\n\nexport const Application = function (isIOS) {\n  this.info = null;\n  this.a4 = parseInt(localStorage.getItem(\"a4\")) || 440;\n  this.tuner = new Tuner(this.a4, isIOS);\n  this.notes = new Notes(\".notes\", this.tuner);\n  this.meter = new Meter(\".meter\");\n  this.frequencyBars = new FrequencyBars(\".frequency-bars\");\n  this.update({\n    name: \"A\",\n    frequency: this.a4,\n    octave: 4,\n    value: 69,\n    cents: 0,\n  });\n};\n\nApplication.prototype.start = function () {\n  const self = this;\n\n  this.tuner.onNoteDetected = function (note) {\n    if (self.notes.isAutoMode) {\n      if (self.lastNote === note.name) {\n        self.update(note);\n      } else {\n        self.lastNote = note.name;\n      }\n    }\n  };\n  this.updateFrequencyBars();\n  this.tuner.init();\n  this.frequencyData = new Uint8Array(self.tuner.analyser.frequencyBinCount);\n};\n\nApplication.prototype.stop = function () {\n  if (window.audioinput && window.audioinput.isCapturing()) {\n    window.audioinput.stop();\n    // window.audioinput.disconnect();\n  }\n};\n\nApplication.prototype.updateFrequencyBars = function () {\n  if (this.tuner.isIOS && this.frequencyData) {\n    let data = Object.values(this.frequencyData);\n    if ( data.some( ( v ) => v >  0 ) ) {\n      ConsoleMessage(`freq obj update (${data.some((v) => v > 0)}): ${data}`);\n      this.frequencyData = new Uint8Array( data );\n    }\n  }\n  \n  if (this.tuner.analyser) {\n    // ConsoleMessage(`freq update ${Obtraject.values(this.frequencyData)}`);\n    let data = new Uint8Array( Object.values( this.frequencyData ) );\n    this.tuner.analyser.getByteFrequencyData(data);\n\n    this.frequencyBars.update(data);\n  }\n  requestAnimationFrame(this.updateFrequencyBars.bind(this));\n};\n\nApplication.prototype.update = function (note) {\n  ConsoleMessage(\"app update\", note.cents);\n  this.notes.update(note);\n  this.meter.update((note.cents / 50) * 45);\n};\n\n// noinspection JSUnusedGlobalSymbols\nApplication.prototype.toggleAutoMode = function () {\n  this.notes.toggleAutoMode();\n};\n\nApplication.prototype.getQVAR = function (obj) {\n  return JSON.stringify(window.audioinput, null, 2);\n};\n\n","<template>\n  <div>\n   <q-item\n      v-if=\"toggleTones\"\n      dense\n      class=\"q-mt-xl q-mr-lg absolute-top-right\"\n      >\n      <q-item-section\n        >\n        <q-icon name=\"notifications_active\"  color=\"accent\" />\n        </q-item-section>\n        <q-item-section class=\"text-accent text-subtitle1\">\n          Tones Enabled\n        </q-item-section>\n      </q-item>\n    <q-fab\n      label-position=\"left\"\n      class=\"q-mt-xl q-ml-lg absolute-top-left bg-accent\"\n      icon=\"settings\"\n      >\n    <q-fab-action\n          color=\"accent\"\n          @click=\"getFreq\"\n          outlined\n          stacked\n          push\n          glossy\n          rounded\n        >\n          <div class=\"text-body1\">\n            <span>A<sub>4</sub></span>\n             = \n             <span>{{ getA4 }} </span>\n            Hz\n          </div>\n        </q-fab-action>\n\n        <q-fab-action>\n         <q-toggle\n          v-model=\"toggleTones\"\n          label=\"Enable Tones\"\n          color=\"accent\"\n          checked-icon=\"check\"\n          unchecked-icon=\"clear\"\n          />\n        </q-fab-action>\n    </q-fab>\n    <canvas class=\"frequency-bars\"></canvas>\n    <div class=\"meter\">\n      <div class=\"meter-dot\"></div>\n      <div class=\"meter-pointer\"></div>\n    </div>\n    <div class=\"notes\">\n      <div class=\"notes-list\"></div>\n      <div class=\"frequency text-h5\"><span></span>Hz</div>\n      <div>\n        \n        <q-btn\n          class=\"q-ma-md\"\n          color=\"accent\"\n          @click=\"q = !q\"\n          label=\"Errors\"\n          icon=\"error\"\n          v-if=\"appInfo !== null\"\n          stacked\n          push\n          glossy\n          rounded\n        />\n\n        <q-dialog v-model=\"q\">\n          <q-card class=\"text-body1 text-center\">\n            <q-card-section>\n              <div class=\"text-h5\">Error:</div>\n            </q-card-section>\n            <q-card-section\n              \n              style=\"max-height: 60vh; max-width: 90vw\">\n              <div v-if=\"appInfo\">{{ app.info }}</div>\n              <div v-else id=\"infoMessage\">{{ getQ($q) }}</div>\n            </q-card-section>\n          </q-card>\n        </q-dialog>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\ndocument.addEventListener(\n  \"deviceready\",\n  () => {\n    console.log(\"deviceready\");\n  },\n  false\n);\nimport { Application } from \"../../middleware/tools/tuner.js\";\n\nexport default {\n  name: \"Tuner\",\n  data: () => ({\n    app: null,\n    q: false,\n  }),\n  computed: {\n    getA4() {\n      return this.app?.a4 || \"440\";\n    },\n    appInfo() {\n      return this.app?.info;\n    },\n    toggleTones: { \n      get() {\n        return !this.app?.notes.isAutoMode;\n      },\n      set(value) {\n        this.app?.notes.toggleAutoMode();\n        this.enableTones = !this.app.notes.isAutoMode || false;\n      }\n    }\n  },\n  mounted() {\n    console.log('mounted')\n    this.app = new Application(this.$q.platform.is.ios);\n    this.app.start();\n  },\n  methods: {\n    getQ(obj) {\n      return this.app?.getQVAR(obj);\n    },\n    setFreq(freq) {\n      this.app.a4 = freq;\n      this.app.tuner.middleA = freq;\n      this.app.notes.createNotes();\n      this.app.update({\n        name: \"A\",\n        frequency: this.app.a4,\n        octave: 4,\n        value: 69,\n        cents: 0,\n      });\n      localStorage.setItem(\"a4\", freq);\n    },\n    getFreq() {\n      this.$q\n        .dialog({\n          title: \"Frequency\",\n          message: \"What frequency would you like to tune to?\",\n          prompt: {\n            model: this.app.a4 || 440,\n            type: \"number\", // optional\n          },\n          cancel: true,\n          standout: true,\n        })\n        .onOk((data) => {\n          console.log(\">>>> OK, received\", data);\n          this.setFreq(data);\n        })\n        .onCancel(() => {\n          // console.log('>>>> Cancel')\n        })\n        .onDismiss(() => {\n          // console.log('I am triggered on both OK and Cancel')\n        });\n    },\n  },\n  destroyed(){\n    this.app?.stop()\n  }\n};\n</script>\n\n<style>\nhtml {\n  height: 100%;\n}\n\nbody {\n  position: fixed;\n  font-family: sans-serif;\n  color: #2c3e50;\n  margin: 0;\n  width: 100%;\n  height: 100%;\n  cursor: default;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n}\n\n.notes {\n  margin: auto;\n  width: 400px;\n  position: fixed;\n  top: 50%;\n  left: 0;\n  right: 0;\n  text-align: center;\n}\n\n.note {\n  font-size: 90px;\n  font-weight: bold;\n  position: relative;\n  display: inline-block;\n  padding-right: 30px;\n  padding-left: 10px;\n}\n\n.note.active {\n  color: #ef6c00;\n}\n\n.notes-list {\n  overflow: auto;\n  overflow: -moz-scrollbars-none;\n  white-space: nowrap;\n  -ms-overflow-style: none;\n  -webkit-mask-image: -webkit-linear-gradient(\n    left,\n    rgba(255, 255, 255, 0),\n    #fff,\n    rgba(255, 255, 255, 0)\n  );\n}\n\n.notes-list::-webkit-scrollbar {\n  display: none;\n}\n\n.note {\n  -webkit-tap-highlight-color: transparent;\n}\n\n.note span {\n  position: absolute;\n  right: 0.25em;\n  font-size: 40%;\n  font-weight: normal;\n}\n\n.note-sharp {\n  top: 0.3em;\n}\n\n.note-octave {\n  bottom: 0.3em;\n}\n\n/* .frequency {\n  font-size: 32px;\n} */\n\n/* .frequency span {\n  font-size: 50%;\n  margin-left: 0.25em;\n} */\n\n.meter {\n  position: fixed;\n  left: 0;\n  right: 0;\n  bottom: 50%;\n  width: 400px;\n  height: 33%;\n  margin: 0 auto 5vh auto;\n}\n\n.meter-pointer {\n  width: 2px;\n  height: 100%;\n  background: #2c3e50;\n  transform: rotate(45deg);\n  transform-origin: bottom;\n  transition: transform 0.5s;\n  position: absolute;\n  right: 50%;\n}\n\n.meter-dot {\n  width: 10px;\n  height: 10px;\n  background: #2c3e50;\n  border-radius: 50%;\n  position: absolute;\n  bottom: -5px;\n  right: 50%;\n  margin-right: -4px;\n}\n\n.meter-scale {\n  width: 1px;\n  height: 100%;\n  transform-origin: bottom;\n  transition: transform 0.2s;\n  box-sizing: border-box;\n  border-top: 10px solid;\n  position: absolute;\n  right: 50%;\n}\n\n.meter-scale-strong {\n  width: 2px;\n  border-top-width: 20px;\n}\n\n.frequency-bars {\n  position: fixed;\n  bottom: 0;\n}\n\n@media (max-width: 768px) {\n  .meter {\n    width: 100%;\n  }\n\n  .notes {\n    width: 100%;\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/@quasar/app/lib/webpack/loader.transform-quasar-imports.js!../../../node_modules/babel-loader/lib/index.js??ref--2-0!../../../node_modules/@quasar/app/lib/webpack/loader.auto-import-client.js?kebab!../../../node_modules/@quasar/app/node_modules/vue-loader/lib/index.js??vue-loader-options!./Tuner.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/@quasar/app/lib/webpack/loader.transform-quasar-imports.js!../../../node_modules/babel-loader/lib/index.js??ref--2-0!../../../node_modules/@quasar/app/lib/webpack/loader.auto-import-client.js?kebab!../../../node_modules/@quasar/app/node_modules/vue-loader/lib/index.js??vue-loader-options!./Tuner.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Tuner.vue?vue&type=template&id=638390eb&\"\nimport script from \"./Tuner.vue?vue&type=script&lang=js&\"\nexport * from \"./Tuner.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Tuner.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@quasar/app/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\nimport QItem from 'quasar/src/components/item/QItem.js';\nimport QItemSection from 'quasar/src/components/item/QItemSection.js';\nimport QIcon from 'quasar/src/components/icon/QIcon.js';\nimport QFab from 'quasar/src/components/fab/QFab.js';\nimport QFabAction from 'quasar/src/components/fab/QFabAction.js';\nimport QToggle from 'quasar/src/components/toggle/QToggle.js';\nimport QBtn from 'quasar/src/components/btn/QBtn.js';\nimport QDialog from 'quasar/src/components/dialog/QDialog.js';\nimport QCard from 'quasar/src/components/card/QCard.js';\nimport QCardSection from 'quasar/src/components/card/QCardSection.js';\nimport qInstall from \"../../../node_modules/@quasar/app/lib/webpack/runtime.auto-import.js\";\nqInstall(component, 'components', {QItem,QItemSection,QIcon,QFab,QFabAction,QToggle,QBtn,QDialog,QCard,QCardSection});\n","// extracted by mini-css-extract-plugin","export * from \"-!../../../node_modules/@quasar/app/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-2-0!../../../node_modules/@quasar/app/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-2-1!../../../node_modules/@quasar/app/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-2-2!../../../node_modules/@quasar/app/lib/webpack/loader.auto-import-client.js?kebab!../../../node_modules/@quasar/app/node_modules/vue-loader/lib/index.js??vue-loader-options!./Tuner.vue?vue&type=style&index=0&lang=css&\""],"sourceRoot":""}