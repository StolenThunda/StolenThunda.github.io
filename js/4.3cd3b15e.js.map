{"version":3,"sources":["webpack:///./src/components/tools/Tuner.vue?35ae","webpack:///./src/middleware/tools/tunerLib.js","webpack:///./src/middleware/tools/tuner.js","webpack:///src/components/tools/Tuner.vue","webpack:///./src/components/tools/Tuner.vue?e1bc","webpack:///./src/components/tools/Tuner.vue","webpack:///./src/components/tools/Tuner.vue?a6c6","webpack:///./src/components/tools/Tuner.vue?1077"],"names":["onAudioInput","evt","consoleMessage","data","length","console","log","onAudioInputError","error","alert","JSON","stringify","msg","debugVar","dir","getMicrophonePermission","onSuccess","onDenied","onError","window","audioinput","checkMicrophonePermission","hasPermission","message","ex","DEBUG_INFO","audioinputInstalled","undefined","ConsoleMessage","trace","addEventListener","Tuner","a4","isIOS","info","middleA","semitone","bufferSize","noteStrings","checkIOSPerms","initGetUserMedia","prototype","AudioContext","webkitAudioContext","navigator","mediaDevices","getUserMedia","constraints","webkitGetUserMedia","mozGetUserMedia","Promise","resolve","reject","call","startRecord","self","start","stream","getStream","audioContext","getAudioContext","setup","microphone","audio","catch","name","source","createMediaStreamSource","connect","analyser","workletNode","destination","getWorkletNode","audioWorklet","addModule","then","tunerNode","AudioWorkletNode","port","onmessage","e","Float32Array","audioData","frequency","pitchDetector","do","onNoteDetected","note","getNote","value","cents","getCents","octave","parseInt","ctx","init","createAnalyser","aubio","Pitch","sampleRate","Math","round","getStandardFrequency","pow","floor","play","oscillator","createOscillator","stop","isCapturing","Notes","selector","tuner","isAutoMode","$root","document","querySelector","$notesList","$frequency","$notes","$notesMap","createNotes","minOctave","maxOctave","n","$note","createElement","className","dataset","toString","innerHTML","appendChild","push","forEach","$active","classList","remove","update","active","clearActive","add","scrollLeft","offsetLeft","clientWidth","childNodes","textContent","parseFloat","toFixed","toggleAutoMode","Meter","$pointer","i","$scale","style","transform","deg","FrequencyBars","$canvas","width","body","height","clientHeight","canvasContext","getContext","clearRect","globalAlpha","fillStyle","fillRect","Application","localStorage","getItem","notes","meter","frequencyBars","lastNote","updateFrequencyBars","frequencyData","Uint8Array","frequencyBinCount","Object","values","some","v","getByteFrequencyData","requestAnimationFrame","bind","getQVAR","obj","props","toggleMenu","type","default","app","q","components","TunerMenuLG","mounted"],"mappings":"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CAIA;AACA,GAtBA,CAuBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAlEA,G;;AC7DgX,CAAgB,qGAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACAhT;AAC3B;AACL;AACa;;;AAGjE;AACsH;AACtH,gBAAgB,8CAAU;AAC1B,EAAE,mCAAM;AACR,EAAE,MAAM;AACR,EAAE,eAAe;AACjB;AACA;AACA;AACA;;AAEA;;AAEe,kGAAiB;AACwB;AACc;AACd;AACH;AACS;AACN;AACc;AACsB;AAC5F,6BAAQ,2BAA2B,+BAAK,CAAC,6CAAY,CAAC,+BAAK,CAAC,6BAAI,CAAC,mCAAO,CAAC,+BAAK,CAAC,6CAAY,CAAC;;;;;;;;AC5B5F,uC;;;;;;;;ACAA;AAAA;AAAA","file":"js/4.3cd3b15e.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('TunerMenuLG',{staticClass:\"gt-xs\",attrs:{\"app\":_vm.app}}),_c('canvas',{staticClass:\"frequency-bars\"}),_vm._m(0),_c('div',{staticClass:\"notes\"},[_c('div',{staticClass:\"notes-list\"}),_vm._m(1),_c('div',[(_vm.info !== '')?_c('q-btn',{staticClass:\"q-ma-md\",attrs:{\"color\":\"accent\",\"label\":\"Errors\",\"icon\":\"error\",\"stacked\":\"\",\"push\":\"\",\"glossy\":\"\",\"rounded\":\"\"},on:{\"click\":function($event){_vm.q = !_vm.q}}}):_vm._e(),_c('q-dialog',{model:{value:(_vm.q),callback:function ($$v) {_vm.q=$$v},expression:\"q\"}},[_c('q-card',[_c('q-card-section',[_c('div',{staticClass:\"text-h5\"},[_vm._v(\"Error:\")])]),_c('q-card-section',{staticStyle:{\"max-height\":\"60vh\",\"max-width\":\"90vw\"}},[_c('div',{domProps:{\"innerHTML\":_vm._s(_vm.info)}})])],1)],1)],1)])],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"meter\"},[_c('div',{staticClass:\"meter-dot\"}),_c('div',{staticClass:\"meter-pointer\"})])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"frequency text-h5\"},[_c('span'),_vm._v(\"Hz\")])}]\n\nexport { render, staticRenderFns }","import { on } from \"@svgdotjs/svg.js\";\n\nexport const onAudioInput = (evt) => {\n  // 'evt.data' is an integer array containing raw audio data\n  //\n  consoleMessage(\"Audio data received: \" + evt.data.length + \" samples\");\n  console.log(\"Audio data received: \" + evt.data.length + \" samples\");\n\n  // ... do something with the evt.data array ...\n};\n\nexport const onAudioInputError = (error) => {\n  alert(\"onAudioInputError event recieved: \" + JSON.stringify(error));\n};\n\nexport function consoleMessage(msg, debugVar) {\n    if ( debugVar ) {\n        msg = `${msg}: ${debugVar}`;\n        if ( typeof debugVar == 'object' ) console.dir( msg, debugVar );\n        else console.log( msg );\n  } \n  console.log(msg);\n}\n\nexport function getMicrophonePermission ( onSuccess, onDenied, onError ) {\n    window.audioinput.checkMicrophonePermission( ( hasPermission ) => {\n        // console.log( `onsuccess: ${onSuccess}` );\n        // console.log( `onDenied: ${onDenied}` );\n        // console.log( `onError: ${onError}` );\n        try {\n            if ( hasPermission ) {\n                if ( onSuccess )\n                    console.log( \"Microphone already has permission granted\" );\n                    onSuccess();\n            } else {\n                window.audioinput.getMicrophonePermission( function (\n                    hasPermission,\n                    message\n                ) {\n                    try {\n                        if ( hasPermission ) {\n                            if ( onSuccess )\n                                console.log( \"Microphone permission granted\" );\n                                onSuccess();\n                        } else {\n                            if ( onDenied )\n                                console.log( \"Microphone permission denied\" );\n                                onDenied( \"User denied permission to record: \" + message );\n                        }\n                    } catch ( ex ) {\n                        if ( onError )\n                            console.log( \"Error getting microphone permission: \" + ex );\n                            onError( \"Start after getting permission exception: \" + ex );\n                    }\n                } );\n            }\n        } catch ( ex ) {\n            if ( onError )\n                console.log( \"Error getting microphone permission: \" + ex );\n                onError( \"getMicrophonePermission exception: \" + ex );\n        }\n    } );\n}\n","import aubio from \"aubiojs\";\nimport { consoleMessage, getMicrophonePermission } from \"./tunerLib.js\";\n\nexport var DEBUG_INFO = null;\nlet audioinputInstalled = (window.audioinput !== undefined);\nconst ConsoleMessage = (...message) => {\n  console.trace(message);\n  DEBUG_INFO += `\\n ${message}`;\n  consoleMessage(message);\n};\n\nconst onAudioInput = (evt) => {\n  // 'evt.data' is an integer array containing raw audio data\n  \n  ConsoleMessage(\"Audio data received: \" + evt.data.length + \" samples\");\n  // ... do something with the evt.data array ...\n  ConsoleMessage( typeof evt );\n};\n\nconst onAudioInputError = (error) => {\n  alert(\"onAudioInputError event recieved: \" + JSON.stringify(error));\n};\n\n// Listen to audioinput events\nwindow.addEventListener(\"audioinput\", onAudioInput, false);\n\n// Listen to audioinputerror events\nwindow.addEventListener(\"audioinputerror\", onAudioInputError, false);\n\n//#region Tuner\nexport const Tuner = function (a4, isIOS) {\n  this.info = null;\n  this.middleA = a4 || 440;\n  this.semitone = 69;\n  this.bufferSize = 4096;\n  this.noteStrings = [\n    \"C\",\n    \"C♯\",\n    \"D\",\n    \"D♯\",\n    \"E\",\n    \"F\",\n    \"F♯\",\n    \"G\",\n    \"G♯\",\n    \"A\",\n    \"A♯\",\n    \"B\",\n  ];\n  this.isIOS = isIOS || false;\n  if (this.isIOS) {\n    // ConsoleMessage(\"initialize IOS tuner\");\n    this.checkIOSPerms();\n  } else {\n    this.initGetUserMedia();\n    // ConsoleMessage(\"initialize WebAudio tuner\");\n  }\n};\n\nTuner.prototype.initGetUserMedia = function () {\n  window.AudioContext = window.AudioContext || window.webkitAudioContext;\n  if (!window.AudioContext) {\n    return alert(\"AudioContext not supported\");\n  }\n\n  // Older browsers might not implement mediaDevices at all, so we set an empty object first\n  if (navigator.mediaDevices === undefined) {\n    navigator.mediaDevices = {};\n  }\n\n  // Some browsers partially implement mediaDevices. We can't just assign an object\n  // with getUserMedia as it would overwrite existing properties.\n  // Here, we will just add the getUserMedia property if it's missing.\n  if (navigator.mediaDevices.getUserMedia === undefined) {\n    navigator.mediaDevices.getUserMedia = function (constraints) {\n      // First get ahold of the legacy getUserMedia, if present\n      const getUserMedia =\n        navigator.webkitGetUserMedia || navigator.mozGetUserMedia;\n\n      // Some browsers just don't implement it - return a rejected promise with an error\n      // to keep a consistent interface\n      if (!getUserMedia) {\n        alert(\"getUserMedia is not implemented in this browser\");\n      }\n\n      // Otherwise, wrap the call to the old navigator.getUserMedia with a Promise\n      return new Promise(function (resolve, reject) {\n        getUserMedia?.call(navigator, constraints, resolve, reject);\n      });\n    };\n  }\n};\n\nTuner.prototype.startRecord = async function () {\n  const self = this;\n  if (self.isIOS) {\n    // ConsoleMessage(\"Microphone input starting...\");\n    window.audioinput.start();\n    // ConsoleMessage(\"Microphone input started!\");\n    let stream = window.audioinput.getStream();\n    // ConsoleMessage(`stream: ${stream}`);\n    this.audioContext = window.audioinput.getAudioContext();\n    self.setup(stream);\n  } else {\n    const microphone = await navigator.mediaDevices\n      .getUserMedia({ audio: true })\n      .catch(function (error) {\n        alert(error.name + \": \" + error.message);\n      });\n    self.setup(microphone);\n  }\n};\n\nTuner.prototype.setup = async function (stream) {\n  // ConsoleMessage(\"setup\");\n  const self = this;\n  self.audioContext = self.getAudioContext();\n  if (!stream) stream = window.audioinput.getStream();\n  let source = self.audioContext.createMediaStreamSource(stream);\n  source\n    .connect(self.analyser)\n    .connect(self.workletNode)\n    .connect(self.audioContext.destination);\n  // ConsoleMessage(\"Microphone input started!\");\n};\n\nTuner.prototype.getWorkletNode = async function () {\n  return await this.audioContext.audioWorklet\n    .addModule(\"worklets/tuner.worklet.js\")\n    .then(async () => {\n      // ConsoleMessage(\"worklet loaded\")\n      let tunerNode = await new AudioWorkletNode(\n        this.audioContext,\n        \"tuner-proc\"\n      );\n      tunerNode.port.onmessage = (e) => {\n        if (e.data instanceof Float32Array) {\n          const audioData = e.data;\n          // process pcm data\n          const frequency = this.pitchDetector.do(audioData);\n          ConsoleMessage(\"worklet data: \", audioData);\n          if (frequency && this.onNoteDetected) {\n            const note = this.getNote(frequency);\n            this.onNoteDetected({\n              name: this.noteStrings[note % 12],\n              value: note,\n              cents: this.getCents(frequency, note),\n              octave: parseInt(note / 12) - 1,\n              frequency: frequency,\n            });\n          }\n        }\n      };\n      return tunerNode;\n    });\n};\n\nTuner.prototype.getAudioContext = function () {\n  let ctx;\n  if (this.audioContext) ctx = this.audioContext;\n  if (window.audioinput) ctx = window.audioinput.getAudioContext();\n  ctx = new (window.AudioContext || window.webkitAudioContext)();\n  return ctx;\n};\n\nTuner.prototype.init = async function () {\n  this.audioContext = this.getAudioContext();\n  this.analyser = this.audioContext.createAnalyser();\n  this.workletNode = await this.getWorkletNode();\n\n  const self = this;\n\n  aubio().then(function (aubio) {\n    self.pitchDetector = new aubio.Pitch(\n      \"default\",\n      self.bufferSize,\n      1,\n      self.audioContext.sampleRate\n    );\n    self.startRecord();\n  });\n};\n\n/**\n * get musical note from frequency\n *\n * @param {number} frequency\n * @returns {number}\n */\nTuner.prototype.getNote = function (frequency) {\n  const note = 12 * (Math.log(frequency / this.middleA) / Math.log(2));\n  return Math.round(note) + this.semitone;\n};\n\n/**\n * get the musical note's standard frequency\n *\n * @param note\n * @returns {number}\n */\nTuner.prototype.getStandardFrequency = function (note) {\n  return this.middleA * Math.pow(2, (note - this.semitone) / 12);\n};\n\n/**\n * get cents difference between given frequency and musical note's standard frequency\n *\n * @param {number} frequency\n * @param {number} note\n * @returns {number}\n */\nTuner.prototype.getCents = function (frequency, note) {\n  return Math.floor(\n    (1200 * Math.log(frequency / this.getStandardFrequency(note))) / Math.log(2)\n  );\n};\n\n/**\n * play the musical note\n *\n * @param {number} frequency\n */\nTuner.prototype.play = function (frequency) {\n  this.audioContext = this.getAudioContext();\n  // ConsoleMessage(`audioContext: ${this.audioContext}`);\n  if (!this.oscillator) {\n    this.oscillator = this.audioContext.createOscillator();\n    this.oscillator.connect(this.audioContext.destination);\n    this.oscillator.start();\n  }\n  this.oscillator.frequency.value = frequency;\n};\n\n\nTuner.prototype.stop = function () {\n  if (this.oscillator) {\n    this.oscillator.stop();\n    this.oscillator = null;\n  }\n\n  // ConsoleMessage(\"Stopped!\");\n};\n\nTuner.prototype.checkIOSPerms = function () {\n  try {\n    if (window.audioinput && !window.audioinput.isCapturing()) {\n      getMicrophonePermission(\n        ConsoleMessage,ConsoleMessage, ConsoleMessage\n      );\n    } else {\n      ConsoleMessage(\"Already capturing!\");\n    }\n  } catch (ex) {\n    ConsoleMessage(\"startCapture exception: \" + ex);\n  }\n};\n//#endregion\n\n//#region Notes\nexport const Notes = function (selector, tuner) {\n  this.tuner = tuner;\n  this.isAutoMode = true;\n  this.$root = document.querySelector(selector);\n  this.$notesList = this.$root.querySelector(\".notes-list\");\n  this.$frequency = this.$root.querySelector(\".frequency\");\n  this.$notes = [];\n  this.$notesMap = {};\n  this.createNotes();\n};\n\nNotes.prototype.createNotes = function () {\n  const minOctave = 2;\n  const maxOctave = 5;\n  for (var octave = minOctave; octave <= maxOctave; octave += 1) {\n    for (var n = 0; n < 12; n += 1) {\n      const $note = document.createElement(\"div\");\n      $note.className = \"note\";\n      $note.dataset.name = this.tuner.noteStrings[n];\n      $note.dataset.value = 12 * (octave + 1) + n;\n      $note.dataset.octave = octave.toString();\n      $note.dataset.frequency = this.tuner.getStandardFrequency(\n        $note.dataset.value\n      );\n      $note.innerHTML =\n        $note.dataset.name[0] +\n        '<span class=\"note-sharp\">' +\n        ($note.dataset.name[1] || \"\") +\n        \"</span>\" +\n        '<span class=\"note-octave\">' +\n        $note.dataset.octave +\n        \"</span>\";\n      this.$notesList.appendChild($note);\n      this.$notes.push($note);\n      this.$notesMap[$note.dataset.value] = $note;\n    }\n  }\n\n  const self = this;\n  this.$notes.forEach(function ($note) {\n    $note.addEventListener(\"click\", function () {\n      if (self.isAutoMode) {\n        return;\n      }\n\n      const $active = self.$notesList.querySelector(\".active\");\n      if ($active === this) {\n        self.tuner.stop();\n        $active.classList.remove(\"active\");\n      } else {\n        self.tuner.play(this.dataset.frequency);\n        self.update($note.dataset);\n      }\n    });\n  });\n};\n\nNotes.prototype.active = function ($note) {\n  // ConsoleMessage(\"active note:\", $note);\n  this.clearActive();\n  $note.classList.add(\"active\");\n  this.$notesList.scrollLeft =\n    $note.offsetLeft - (this.$notesList.clientWidth - $note.clientWidth) / 2;\n};\n\nNotes.prototype.clearActive = function () {\n  const $active = this.$notesList.querySelector(\".active\");\n  if ($active) {\n    $active.classList.remove(\"active\");\n  }\n};\n\nNotes.prototype.update = function (note) {\n  // ConsoleMessage(\"update note val\", note.value);\n  if (note.value in this.$notesMap) {\n    this.active(this.$notesMap[note.value]);\n    this.$frequency.childNodes[0].textContent = parseFloat(\n      note.frequency\n    ).toFixed(1);\n  }\n};\n\nNotes.prototype.toggleAutoMode = function () {\n  if (this.isAutoMode) {\n    this.clearActive();\n  } else {\n    this.tuner.stop();\n  }\n  this.isAutoMode = !this.isAutoMode;\n};\n//#endregion\n\n//#region Meter\n/**\n * @param {string} selector\n * @constructor\n */\nexport const Meter = function (selector) {\n  this.$root = document.querySelector(selector);\n  this.$pointer = this.$root.querySelector(\".meter-pointer\");\n  this.init();\n};\n\nMeter.prototype.init = function () {\n  for (var i = 0; i <= 10; i += 1) {\n    const $scale = document.createElement(\"div\");\n    $scale.className = \"meter-scale\";\n    $scale.style.transform = \"rotate(\" + (i * 9 - 45) + \"deg)\";\n    if (i % 5 === 0) {\n      $scale.classList.add(\"meter-scale-strong\");\n    }\n    this.$root.appendChild($scale);\n  }\n};\n\n/**\n * @param {number} deg\n */\nMeter.prototype.update = function (deg) {\n  // ConsoleMessage(`deg: ${deg}`);\n  this.$pointer.style.transform = \"rotate(\" + deg + \"deg)\";\n};\n//#endregion\n\n//#region Frequency Bars\n/**\n * the frequency histogram\n *\n * @param {string} selector\n * @constructor\n */\nexport const FrequencyBars = function (selector) {\n  this.$canvas = document.querySelector(selector);\n  this.$canvas.width = document.body.clientWidth;\n  this.$canvas.height = document.body.clientHeight / 2;\n  this.canvasContext = this.$canvas.getContext(\"2d\");\n};\n\n/**\n * @param {Uint8Array} data\n */\nFrequencyBars.prototype.update = function (data) {\n  const length = 64; // low frequency only\n  const width = this.$canvas.width / length - 0.5;\n  this.canvasContext.clearRect(0, 0, this.$canvas.width, this.$canvas.height);\n  this.canvasContext.globalAlpha = 0.35;\n  for (var i = 0; i < length; i += 1) {\n    this.canvasContext.fillStyle = \"#ef6c00\";\n    this.canvasContext.fillRect(\n      i * (width + 0.5),\n      this.$canvas.height - data[i],\n      width,\n      data[i]\n    );\n  }\n};\n//#endregion\n\n//#region Application\nexport const Application = function (isIOS) {\n  this.a4 = parseInt(localStorage.getItem(\"a4\")) || 440;\n  this.tuner = new Tuner(this.a4, isIOS);\n  this.notes = new Notes(\".notes\", this.tuner);\n  this.meter = new Meter(\".meter\");\n  this.frequencyBars = new FrequencyBars(\".frequency-bars\");\n  this.update({\n    name: \"A\",\n    frequency: this.a4,\n    octave: 4,\n    value: 69,\n    cents: 0,\n  });\n};\n\nApplication.prototype.start = function () {\n  const self = this;\n\n  this.tuner.onNoteDetected = function (note) {\n    if (self.notes.isAutoMode) {\n      if (self.lastNote === note.name) {\n        self.update(note);\n      } else {\n        self.lastNote = note.name;\n      }\n    }\n  };\n  this.updateFrequencyBars();\n  this.tuner.init();\n  this.frequencyData = new Uint8Array(self.tuner.analyser.frequencyBinCount);\n};\n\nApplication.prototype.stop = function () {\n  if (window.audioinput && window.audioinput.isCapturing()) {\n    window.audioinput.stop();\n  }\n};\n\nApplication.prototype.updateFrequencyBars = function () {\n  if (this.tuner.isIOS && this.frequencyData) {\n    let data = Object.values(this.frequencyData);\n    if (data.some((v) => v > 0)) {\n      // ConsoleMessage(`freq obj update (${data.some((v) => v > 0)}): ${data}`);\n      this.frequencyData = new Uint8Array(data);\n    }\n  }\n\n  if (this.tuner.analyser) {\n    let data = new Uint8Array(Object.values(this.frequencyData));\n    this.tuner.analyser.getByteFrequencyData(data);\n\n    this.frequencyBars.update(data);\n  }\n  requestAnimationFrame(this.updateFrequencyBars.bind(this));\n};\n\nApplication.prototype.update = function (note) {\n  // ConsoleMessage(\"app update\", note.cents);\n  this.notes.update(note);\n  this.meter.update((note.cents / 50) * 45);\n};\n\n// noinspection JSUnusedGlobalSymbols\nApplication.prototype.toggleAutoMode = function () {\n  this.notes.toggleAutoMode();\n};\n\nApplication.prototype.getQVAR = function (obj) {\n  return JSON.stringify(window.audioinput, null, 2);\n};\n//#endregion\n","<template>\n  <div>\n    <!-- <q-item v-if=\"toggleTones\" dense class=\"q-mt-xl q-mr-lg absolute-top-right\">\n      <q-item-section>\n        <q-icon name=\"notifications_active\" color=\"accent\" size=\"lg\" />\n      </q-item-section>\n      <q-item-section class=\"text-accent text-subtitle1\">\n        Tones Enabled\n      </q-item-section>\n    </q-item> -->\n  <TunerMenuLG class=\"gt-xs\" :app=\"app\" />\n  <!-- <TunerMenuSM class=\"lt-sm\" :app=\"app\" /> -->\n    <canvas class=\"frequency-bars\"></canvas>\n    <div class=\"meter\">\n      <div class=\"meter-dot\"></div>\n      <div class=\"meter-pointer\"></div>\n    </div>\n    <div class=\"notes\">\n      <div class=\"notes-list\"></div>\n      <div class=\"frequency text-h5\"><span></span>Hz</div>\n      <div>\n        <q-btn\n          class=\"q-ma-md\"\n          color=\"accent\"\n          @click=\"q = !q\"\n          label=\"Errors\"\n          icon=\"error\"\n          v-if=\"info !== ''\"\n          stacked\n          push\n          glossy\n          rounded\n        />\n\n        <q-dialog v-model=\"q\">\n          <q-card>\n            <q-card-section>\n              <div class=\"text-h5\">Error:</div>\n            </q-card-section>\n            <q-card-section style=\"max-height: 60vh; max-width: 90vw\">\n              <div v-html=\"info\" />\n              <!-- <div v-id=\"infoMessage\">{{ getQ($q) }}</div> -->\n            </q-card-section>\n          </q-card>\n        </q-dialog>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\ndocument.addEventListener(\n  \"deviceready\",\n  () => {\n    console.log(\"deviceready\");\n  },\n  false\n);\nimport { Application, DEBUG_INFO } from \"../../middleware/tools/tuner.js\";\n// import TunerMenuLG from \"./TunerMenuLG.vue\";\n// import TunerMenuSm from \"./TunerMenuSm.vue\";\n\nexport default {\n  name: \"Tuner\",\n  props: {\n    toggleMenu: { \n      type: Boolean,\n      default: false\n    }\n  },\n  data: () => ({\n    app: null,\n    q: false,\n    info: DEBUG_INFO,\n  }),\n  components: { \n    TunerMenuLG: () => import('./TunerMenuLG.vue'), \n    // TunerMenuSM: () => import('./TunerMenuSm.vue') \n    },\n  mounted() {\n    // console.log(\"mounted\");\n    this.app = new Application(this.$q.platform.is.ios);\n    this.app.start();\n    this.$emit('app-loaded', this.app); // emit event to parent\n  },\n  // methods: { \n  //   getQ(obj) {\n  //     return DEBUG_INFO;\n  //   },\n  //   setFreq(freq) {\n  //     this.app.a4 = freq;\n  //     this.app.tuner.middleA = freq;\n  //     this.app.notes.createNotes();\n  //     this.app.update({\n  //       name: \"A\",\n  //       frequency: this.app.a4,\n  //       octave: 4,\n  //       value: 69,\n  //       cents: 0,\n  //     });\n  //     localStorage.setItem(\"a4\", freq);\n  //   },\n  //   getFreq() {\n  //     this.$q\n  //       .dialog({\n  //         title: \"Frequency\",\n  //         message: \"What frequency would you like to tune to?\",\n  //         prompt: {\n  //           model: this.app.a4 || 440,\n  //           type: \"number\", // optional\n  //         },\n  //         cancel: true,\n  //         standout: true,\n  //       })\n  //       .onOk((data) => {\n  //         console.log(\">>>> OK, received\", data);\n  //         this.setFreq(data);\n  //       })\n  //       .onCancel(() => {\n  //         // console.log('>>>> Cancel')\n  //       })\n  //       .onDismiss(() => {\n  //         // console.log('I am triggered on both OK and Cancel')\n  //       });\n  //   },\n  // },\n  // destroyed() {\n  //   this.app?.stop();\n  // },\n};\n</script>\n\n<style>\nhtml {\n  height: 100%;\n}\n\nbody {\n  position: fixed;\n  font-family: sans-serif;\n  color: #2c3e50;\n  margin: 0;\n  width: 100%;\n  height: 100%;\n  cursor: default;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n}\n\n.notes {\n  margin: auto;\n  width: 400px;\n  position: fixed;\n  top: 50%;\n  left: 0;\n  right: 0;\n  text-align: center;\n}\n\n.note {\n  font-size: 90px;\n  font-weight: bold;\n  position: relative;\n  display: inline-block;\n  padding-right: 30px;\n  padding-left: 10px;\n}\n\n.note.active {\n  color: #ef6c00;\n}\n\n.notes-list {\n  overflow: auto;\n  overflow: -moz-scrollbars-none;\n  white-space: nowrap;\n  -ms-overflow-style: none;\n  -webkit-mask-image: -webkit-linear-gradient(\n    left,\n    rgba(255, 255, 255, 0),\n    #fff,\n    rgba(255, 255, 255, 0)\n  );\n}\n\n.notes-list::-webkit-scrollbar {\n  display: none;\n}\n\n.note {\n  -webkit-tap-highlight-color: transparent;\n}\n\n.note span {\n  position: absolute;\n  right: 0.25em;\n  font-size: 40%;\n  font-weight: normal;\n}\n\n.note-sharp {\n  top: 0.3em;\n}\n\n.note-octave {\n  bottom: 0.3em;\n}\n\n/* .frequency {\n  font-size: 32px;\n} */\n\n/* .frequency span {\n  font-size: 50%;\n  margin-left: 0.25em;\n} */\n\n.meter {\n  position: fixed;\n  left: 0;\n  right: 0;\n  bottom: 50%;\n  width: 400px;\n  height: 33%;\n  margin: 0 auto 5vh auto;\n}\n\n.meter-pointer {\n  width: 2px;\n  height: 100%;\n  background: #2c3e50;\n  transform: rotate(45deg);\n  transform-origin: bottom;\n  transition: transform 0.5s;\n  position: absolute;\n  right: 50%;\n}\n\n.meter-dot {\n  width: 10px;\n  height: 10px;\n  background: #2c3e50;\n  border-radius: 50%;\n  position: absolute;\n  bottom: -5px;\n  right: 50%;\n  margin-right: -4px;\n}\n\n.meter-scale {\n  width: 1px;\n  height: 100%;\n  transform-origin: bottom;\n  transition: transform 0.2s;\n  box-sizing: border-box;\n  border-top: 10px solid;\n  position: absolute;\n  right: 50%;\n}\n\n.meter-scale-strong {\n  width: 2px;\n  border-top-width: 20px;\n}\n\n.frequency-bars {\n  position: fixed;\n  bottom: 0;\n}\n\n@media (max-width: 768px) {\n  .meter {\n    width: 100%;\n  }\n\n  .notes {\n    width: 100%;\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/@quasar/app/lib/webpack/loader.transform-quasar-imports.js!../../../node_modules/babel-loader/lib/index.js??ref--2-0!../../../node_modules/@quasar/app/lib/webpack/loader.auto-import-client.js?kebab!../../../node_modules/@quasar/app/node_modules/vue-loader/lib/index.js??vue-loader-options!./Tuner.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/@quasar/app/lib/webpack/loader.transform-quasar-imports.js!../../../node_modules/babel-loader/lib/index.js??ref--2-0!../../../node_modules/@quasar/app/lib/webpack/loader.auto-import-client.js?kebab!../../../node_modules/@quasar/app/node_modules/vue-loader/lib/index.js??vue-loader-options!./Tuner.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Tuner.vue?vue&type=template&id=5fec7213&\"\nimport script from \"./Tuner.vue?vue&type=script&lang=js&\"\nexport * from \"./Tuner.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Tuner.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@quasar/app/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\nimport QItem from 'quasar/src/components/item/QItem.js';\nimport QItemSection from 'quasar/src/components/item/QItemSection.js';\nimport QIcon from 'quasar/src/components/icon/QIcon.js';\nimport QBtn from 'quasar/src/components/btn/QBtn.js';\nimport QDialog from 'quasar/src/components/dialog/QDialog.js';\nimport QCard from 'quasar/src/components/card/QCard.js';\nimport QCardSection from 'quasar/src/components/card/QCardSection.js';\nimport qInstall from \"../../../node_modules/@quasar/app/lib/webpack/runtime.auto-import.js\";\nqInstall(component, 'components', {QItem,QItemSection,QIcon,QBtn,QDialog,QCard,QCardSection});\n","// extracted by mini-css-extract-plugin","export * from \"-!../../../node_modules/@quasar/app/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-2-0!../../../node_modules/@quasar/app/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-2-1!../../../node_modules/@quasar/app/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-2-2!../../../node_modules/@quasar/app/lib/webpack/loader.auto-import-client.js?kebab!../../../node_modules/@quasar/app/node_modules/vue-loader/lib/index.js??vue-loader-options!./Tuner.vue?vue&type=style&index=0&lang=css&\""],"sourceRoot":""}